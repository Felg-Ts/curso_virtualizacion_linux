
virsh -c qemu:///system vol-clone vol1.qcow2 template-debian.qcow2 --pool default
Se ha colando el volumen template-debian.qcow2 a partir de vol1.qcow2


apt-get install libguestfs-tools

sudo virt-sysprep -a /var/lib/libvirt/images/template-debian.qcow2 --hostname template-debian
[   0.0] Examining the guest ...
[  18.9] Performing "abrt-data" ...
[  18.9] Performing "backup-files" ...
[  19.1] Performing "bash-history" ...
[  19.2] Performing "blkid-tab" ...
[  19.2] Performing "crash-data" ...
[  19.2] Performing "cron-spool" ...
[  19.3] Performing "dhcp-client-state" ...
[  19.3] Performing "dhcp-server-state" ...
[  19.3] Performing "dovecot-data" ...
[  19.3] Performing "ipa-client" ...
[  19.3] Performing "kerberos-hostkeytab" ...
[  19.4] Performing "logfiles" ...
[  19.5] Performing "machine-id" ...
[  19.5] Performing "mail-spool" ...
[  19.5] Performing "net-hostname" ...
[  19.5] Performing "net-hwaddr" ...
[  19.6] Performing "pacct-log" ...
[  19.6] Performing "package-manager-cache" ...
[  19.7] Performing "pam-data" ...
[  19.7] Performing "passwd-backups" ...
[  19.7] Performing "puppet-data-log" ...
[  19.8] Performing "rh-subscription-manager" ...
[  19.8] Performing "rhn-systemid" ...
[  19.9] Performing "rpm-db" ...
[  19.9] Performing "samba-db-log" ...
[  19.9] Performing "script" ...
[  19.9] Performing "smolt-uuid" ...
[  20.0] Performing "ssh-hostkeys" ...
[  20.0] Performing "ssh-userdir" ...
[  20.0] Performing "sssd-db-log" ...
[  20.0] Performing "tmp-files" ...
[  20.1] Performing "udev-persistent-net" ...
[  20.1] Performing "utmp" ...
[  20.1] Performing "yum-uuid" ...
[  20.2] Performing "customize" ...
[  20.2] Setting a random seed
[  20.2] Setting the machine ID in /etc/machine-id
[  20.2] Setting the hostname: template-debian
[  21.3] Performing "lvm-uuids" ...


Clonación completa



virsh -c qemu:///system vol-clone template-debian.qcow2 prueba5.qcow2 --pool default


virt-install --connect qemu:///system \
			 --virt-type kvm \
			 --name prueba5 \
			 --os-variant debian10 \
			 --disk vol=default/prueba5.qcow2 \
			 --memory 1024 \
			 --vcpus 1

Y con virt-manager

Conación ligera

Crear volukmen con backing store

virsh -c qemu:///system vol-create-as default prueba6.qcow2 10 --format qcow2 --backing-vol template-debian.qcow2

sudo qemu-img create -f qcow2 prueba6.qcow2 10G -b template-debian.qcow2

Con virt-manager

Y volvemos a crear una mv


